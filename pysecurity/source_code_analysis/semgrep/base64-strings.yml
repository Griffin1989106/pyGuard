rules:
  - id: base64-strings
    languages:
      - python
    message: Found a hardcoded, base64-encoded variable $STR. Might be an obscured attack.
    patterns:
    - pattern-either:
      - pattern: ("$STR").decode(...)
      - pattern: base64.b64decode("$STR")
      - pattern: b64decode("$STR")
      - pattern: $VAR = "$STR"
    - metavariable-analysis:
        analyzer: entropy
        metavariable: $STR
    - metavariable-regex:
        metavariable: $STR
        regex: ^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$
    severity: WARNING
