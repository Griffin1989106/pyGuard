# TODO: Detects these links well, but lots of legitimate packages seem to use these domain extensions
rules:
  - id: shady-links
    patterns: 
      - pattern: "$LINK"
      - metavariable-pattern:
          metavariable: $LINK
          patterns:
            - pattern-either:
                - pattern-regex: .*bit\.ly.*
                - pattern-regex: http[s]?:\/\/.*\.(link|xyz|tk|ml|ga|cf|gq|xyz|pw|top|club|mw|bd|ke|am|sbs|date|quest|cd|bid|cd|ws|icu|cam|uno|email|stream)[\/]?
    paths:
      exclude:
        - "tests/*"
        - "test/*"
    message: Detected an unsafe link to $LINK.
    languages:
      - python
    severity: WARNING
